<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>WIMP3</title>
</head>
<body>
  <h1>WIMP3 Converter</h1>
  <input type="file" id="file" accept="video/*">
  <button id="btn">Convert</button>
  <div id="result"></div>

  <script>
    const API = location.hostname === 'localhost' ? 'http://localhost:3000' : location.origin;

    btn.onclick = async () => {
      const f = file.files[0];
      if (!f) return alert('Select video');

      result.innerHTML = '⏳ Converting...';

      const fd = new FormData();
      fd.append('video', f);

      try {
        const r = await fetch(`${API}/convert`, { method: 'POST', body: fd });
        const d = await r.json();
        
        if (d.success) {
          result.innerHTML = `✅ Done<br><a href="${API}${d.downloadUrl}" download>Download MP3 (${(d.size/1024/1024).toFixed(2)}MB)</a>`;
        }
      } catch (e) {
        result.innerHTML = `❌ ${e.message}`;
      }
    };
  </script>
</body>
</html>